<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="ad.size" content="width=300,height=250" />
  <title>300x250_NF_DE_CATEGORY_KAT_AlwaysOn_CATEGORY_HTML5</title>

  <script>
    // ====== GENERATOR VARS (werden ersetzt) ======
    // ✅ Wichtig: einfache, eindeutige Muster, damit dein Generator sicher ersetzen kann.
    var HEADLINE = "Bereit für deine Ziele?";
    var SUBLINE  = "Sport Outfits entdecken!";
    var CTA_TEXT = "Jetzt shoppen";

    // ====== THEME VARS (werden ersetzt / vom Generator injiziert) ======
    // Standard: leere Strings => Template Default
    // Sale:    THEME_HEADLINE_COLOR=#BE2D2F, THEME_SUBLINE_COLOR=#1b1b1b, THEME_CTA_ACCENT=#BE2D2F
    // TC:      THEME_HEADLINE_COLOR=#004266, THEME_SUBLINE_COLOR=#1b1b1b, THEME_CTA_ACCENT=#004266
    var THEME_KEY = "standard";
    var THEME_HEADLINE_COLOR = "";
    var THEME_SUBLINE_COLOR  = "";
    var THEME_CTA_ACCENT     = "";

    // ✅ IMAGE_LIST: Generator ersetzt komplett (mit 1.jpg,2.jpg... ODER blob:-URLs / data:-URLs in Preview)
    // Hinweis: IMAGE_PATTERN wurde entfernt, da IMAGE_LIST immer korrekt ist.
    var IMAGE_LIST = [
      "960x1200-1_NF_DE_Active_HVK_2025KW02_Active.jpg",
      "960x1200-2_NF_DE_Active_HVK_2025KW02_Active.jpg"
    ];

    // ✅ DV360 clickTag (muss global sein)
    var clickTag = "https://example.com";
    window.clickTag = clickTag;
  </script>

  <!-- ===== FONT PRELOADS (reduziert FOUT stark) ===== -->
  <link rel="preload" href="fonts/InterstateWGL-Regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="fonts/InterstateWGL-Bold.woff2" as="font" type="font/woff2" crossorigin>

  <!-- ===== Optional: Banner erst zeigen, wenn Fonts geladen sind (verhindert sichtbaren Font-Swap) ===== -->
  <style>
    html.fonts-loading .ad { opacity: 0; }
    html.fonts-loaded  .ad { opacity: 1; transition: opacity 80ms linear; }
  </style>
  <script>
    document.documentElement.classList.add("fonts-loading");
    (document.fonts ? document.fonts.ready : Promise.resolve()).then(function(){
      document.documentElement.classList.remove("fonts-loading");
      document.documentElement.classList.add("fonts-loaded");
    });
  </script>

  <style>
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }

    :root{
      --w: 300px;
      --h: 250px;

      /* Default Gold (Standard) */
      --gold: #C0A468;

      /* Theme Overrides (werden via JS gesetzt, wenn Theme-Variablen vorhanden sind) */
      --headlineColor: #1f2430;    /* Default Headline */
      --sublineColor:  var(--gold);/* Default Subline */
      --ctaAccent:     var(--gold);/* Default CTA "Gold" */

      --pad: 12px;
      --gap: 10px;

      --logoH: 26px;

      --headlineFs: 18px;
      --headlineLh: 1.12;
      --sublineFs: 14px;
      --sublineLh: 1.18;

      --ctaFs: 12px;
      --hoverDur: 1050ms;

      --swipeMs: 450ms;

      --frameW: 1px;

      --heroBorderW: 5px;
      --heroBorderAlpha: 0.95;
      --heroBorderFalloff: 0.30;
      --heroBorderDur: 180ms;
    }

    /* ===== WEBFONTS (sauber nach Gewicht/Style getrennt) ===== */
    @font-face{
      font-family:"InterstateWGL";
      src:
        url("fonts/InterstateWGL-Regular.woff2") format("woff2"),
      font-weight:400;
      font-style:normal;
      font-display:optional;
    }
    @font-face{
      font-family:"InterstateWGL";
      src:
        url("fonts/InterstateWGL-Bold.woff2") format("woff2"),
      font-weight:700;
      font-style:normal;
      font-display:optional;
    }

    .ad{
      width: var(--w);
      height: var(--h);
      overflow: hidden;
      background:#fff;
      font-family:"InterstateWGL", Arial, Helvetica, sans-serif;
      position: relative;
      cursor: pointer;

      /* Rahmen bleibt IMMER Gold (wie gewünscht) */
      border: var(--frameW) solid var(--gold);
    }

    .wrap{ position:absolute; inset:0; display:flex; }

    .left{
      width: 50%;
      padding: var(--pad);
      display:flex;
      flex-direction: column;
      background:#fff;
      position:relative;
      overflow:hidden;
    }

    /* Hero Border bleibt IMMER Gold (wie gewünscht) */
    .left::after{
      content:"";
      position:absolute; inset:0;
      pointer-events:none;
      opacity:0;
      transition: opacity var(--heroBorderDur) ease;
      background:
        linear-gradient(to bottom, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) top / 100% var(--heroBorderW) no-repeat,
        linear-gradient(to top, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) bottom / 100% var(--heroBorderW) no-repeat,
        linear-gradient(to right, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) left / var(--heroBorderW) 100% no-repeat,
        linear-gradient(to left, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) right / var(--heroBorderW) 100% no-repeat;
      z-index:10;
    }
    .left:hover::after{ opacity:1; }

    .logo{ display:flex; justify-content:center; align-items:flex-start; }
    .logo img{ height: var(--logoH); width:auto; display:block; }

    .copy{
      flex: 1 1 auto;
      display:flex;
      flex-direction: column;
      justify-content: center;
      gap: var(--gap);
      text-align:center;
      padding: 6px 0;
    }

    .headline{
      margin:0; width:100%;
      font-size: var(--headlineFs);
      line-height: var(--headlineLh);
      font-weight: 700;
      color: var(--headlineColor);
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }

    .subline{
      margin:0; width:100%;
      font-size: var(--sublineFs);
      line-height: var(--sublineLh);
      font-style: normal;
      font-weight: 400;
      color: var(--sublineColor);
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }

    .cta-area{ display:flex; justify-content:center; align-items:flex-end; }

    .cta{
      position:relative;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 8px 14px;
      border-radius: 999px;
      font-size: var(--ctaFs);
      font-weight: 700;
      text-decoration:none;
      user-select:none;
      cursor:pointer;

      /* CTA "Gold" wird themable */
      background: var(--ctaAccent);

      border: 2px solid transparent;
      overflow:hidden;
    }

    .cta::before{
      content:"";
      position:absolute; inset:0;
      width:0%;
      background:#fff;
      z-index:1;
      pointer-events:none;
      transition:none;
    }

    .cta-inner{
      position:relative; z-index:2;
      white-space:nowrap;
      line-height:1;
      display:inline-block;
      color:#fff;
      transition:none;
      will-change:transform;
    }

    @supports (-webkit-background-clip:text) or (background-clip:text){
      .cta-inner{
        color:transparent;
        -webkit-text-fill-color:transparent;
        -webkit-background-clip:text;
        background-clip:text;

        background-image: linear-gradient(90deg, var(--ctaAccent) 0%, var(--ctaAccent) 50%, #ffffff 50%, #ffffff 100%);
        background-size:200% 100%;
        background-position:100% 0;
      }
    }

    .cta.is-hover{ border-color: var(--ctaAccent); }
    .cta.is-hover::before{ width:100%; transition: width var(--hoverDur) linear; }
    .cta.is-hover .cta-inner{ color: var(--ctaAccent); }
    @supports (-webkit-background-clip:text) or (background-clip:text){
      .cta.is-hover .cta-inner{ background-position:0% 0; transition: background-position var(--hoverDur) linear; }
    }

    .right{
      width: 50%;
      position:relative;
      overflow:hidden;
      background:#fff;
    }

    /* Hero Border bleibt IMMER Gold (wie gewünscht) */
    .right::after{
      content:"";
      position:absolute; inset:0;
      pointer-events:none;
      opacity:0;
      transition: opacity var(--heroBorderDur) ease;
      background:
        linear-gradient(to bottom, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) top / 100% var(--heroBorderW) no-repeat,
        linear-gradient(to top, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) bottom / 100% var(--heroBorderW) no-repeat,
        linear-gradient(to right, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) left / var(--heroBorderW) 100% no-repeat,
        linear-gradient(to left, rgba(192,164,104,var(--heroBorderAlpha)) 0%,
          rgba(192,164,104,var(--heroBorderAlpha)) calc(var(--heroBorderFalloff) * 100%),
          rgba(192,164,104,0) 100%) right / var(--heroBorderW) 100% no-repeat;
      z-index: 5;
    }
    .right:hover::after{ opacity:1; }

    .slide{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: cover;
      object-position: center;
      display:block;
      transform: translateX(0);
      transition: transform var(--swipeMs) ease;
      will-change: transform;
      pointer-events:none;
    }

    .no-trans { transition: none !important; }
    .pos-center { transform: translateX(0); }
    .pos-right  { transform: translateX(100%); }
    .pos-left   { transform: translateX(-100%); }

    /* Sequenz */
    .seq{ opacity:0; transform: translateY(10px); }
    .seq-img{ opacity:0; }
    @keyframes fadeUp{ from{opacity:0;transform:translateY(10px);} to{opacity:1;transform:translateY(0);} }
    @keyframes fadeIn{ from{opacity:0;} to{opacity:1;} }
    .show-logo{ animation:fadeUp 1000ms cubic-bezier(.2,.9,.2,1) forwards; animation-delay:0ms; }
    .show-headline{ animation:fadeUp 1000ms cubic-bezier(.2,.9,.2,1) forwards; animation-delay:200ms; }
    .show-image{ animation:fadeIn 1000ms ease forwards; animation-delay:450ms; }
    .show-subline{ animation:fadeUp 1000ms cubic-bezier(.2,.9,.2,1) forwards; animation-delay:700ms; }
    .show-cta{ animation:fadeUp 1000ms cubic-bezier(.2,.9,.2,1) forwards; animation-delay:900ms; }
  </style>
</head>

<body>
  <img
    src="https://tagm.tchibo.de/ai.aspx?extProvId=300&extProvApi=129768&extPu=tchibo-dv360&extLi=${INSERTION_ORDER_ID}&extPm=${CAMPAIGN_ID}&extCr=${CREATIVE_ID}&adslotid=${PUBLISHER_ID}&gdpr=${GDPR}&gdpr_consent=${GDPR_CONSENT_312}&cb=${CACHEBUSTER}"
    width="1" height="1" style="display:none" alt=""
  >

  <div class="ad" id="ad" role="button" aria-label="Anzeige öffnen">
    <div class="wrap">
      <div class="left">
        <div class="logo seq show-logo">
          <!-- ✅ robust: Logo wird per JS ggf. auf ../Logo.png umgeschrieben (Preview mit <base href="./assets/"> ) -->
          <img id="logoImg" src="Logo.png" alt="Logo">
        </div>

        <div class="copy">
          <p class="headline seq show-headline" id="headlineEl"></p>
          <p class="subline  seq show-subline"  id="sublineEl"></p>
        </div>

        <div class="cta-area">
          <a class="cta seq show-cta" href="javascript:void(0)" id="cta">
            <span class="cta-inner" id="ctaInner"></span>
          </a>
        </div>
      </div>

      <div class="right seq-img show-image" aria-hidden="true">
        <img class="slide pos-center" id="slideA" src="" alt="">
        <img class="slide pos-right"  id="slideB" src="" alt="">
      </div>
    </div>
  </div>

  <script>
    // -----------------------
    // Theme apply
    // -----------------------
    (function applyTheme(){
      var headlineColor = (typeof THEME_HEADLINE_COLOR === "string" && THEME_HEADLINE_COLOR.trim()) ? THEME_HEADLINE_COLOR.trim() : "";
      var sublineColor  = (typeof THEME_SUBLINE_COLOR  === "string" && THEME_SUBLINE_COLOR.trim())  ? THEME_SUBLINE_COLOR.trim()  : "";
      var ctaAccent     = (typeof THEME_CTA_ACCENT     === "string" && THEME_CTA_ACCENT.trim())     ? THEME_CTA_ACCENT.trim()     : "";

      if (headlineColor) document.documentElement.style.setProperty("--headlineColor", headlineColor);
      if (sublineColor)  document.documentElement.style.setProperty("--sublineColor",  sublineColor);
      if (ctaAccent)     document.documentElement.style.setProperty("--ctaAccent",     ctaAccent);
    })();

    // -----------------------
    // ✅ Preview/Export Path Resolver
    // Problem: Generator setzt in Preview oft <base href="./assets/">
    // Dann werden "Logo.png" / "1.jpg" fälschlich zu "./assets/Logo.png" / "./assets/1.jpg".
    // Export ZIP hat die Dateien aber im Root => wir müssen in Preview auf "../" umbiegen.
    // -----------------------
    function resolveSrc(s){
      s = String(s || "");
      if (!s) return s;

      // data/blob/http(s) bleiben unverändert
      if (/^(data:|blob:|https?:\/\/)/i.test(s)) return s;

      // Wenn bereits relativ/absolut geschrieben wurde, lassen wir es
      if (s.indexOf("../") === 0 || s.indexOf("./") === 0 || s.indexOf("/") === 0) return s;

      var baseEl = document.querySelector("base");
      var baseHref = baseEl ? (baseEl.getAttribute("href") || "") : "";

      // Wenn base auf assets zeigt: Root-Dateien liegen eine Ebene höher
      if (baseHref && /(^|\/)assets\/?$/i.test(baseHref.trim())){
        return "../" + s;
      }

      // Normalfall (ohne base): Root-Datei direkt
      return s;
    }

    // -----------------------
    // Texte setzen
    // -----------------------
    document.getElementById("headlineEl").textContent = HEADLINE;
    document.getElementById("sublineEl").textContent  = SUBLINE;
    document.getElementById("ctaInner").textContent   = CTA_TEXT;

    // -----------------------
    // ✅ Logo robust machen (Preview <base> + Export)
    // -----------------------
    (function fixLogo(){
      var img = document.getElementById("logoImg");
      if (!img) return;

      // Setze direkt resolved src (ohne onerror-Wartezeit)
      img.src = resolveSrc("Logo.png");

      // Fallbacks, falls ein Setup abweicht (z.B. Logo wirklich in assets/)
      img.onerror = function(){
        // 1) wenn base-assets aktiv war, könnte Logo doch in assets liegen
        img.onerror = function(){
          // 2) letzter Versuch: ../assets/Logo.png
          img.onerror = null;
          img.src = "../assets/Logo.png";
        };
        img.src = "assets/Logo.png";
      };
    })();

    // -----------------------
    // ClickTag
    // -----------------------
    function doExit(){ window.open(clickTag, "_blank"); }
    document.getElementById("ad").addEventListener("click", doExit);

    var cta = document.getElementById("cta");
    cta.addEventListener("click", function(e){ e.preventDefault(); e.stopPropagation(); doExit(); });
    cta.addEventListener("mouseenter", function(){ cta.classList.add("is-hover"); });
    cta.addEventListener("mouseleave", function(){ cta.classList.remove("is-hover"); });

    // ===== Slider =====
    var HOLD_MS  = 2000;
    var SWIPE_MS = 450;
    var heroFullyVisibleAt = 450 + 1000;

    var slideA = document.getElementById("slideA");
    var slideB = document.getElementById("slideB");

    function setPos(el, posClass){
      el.classList.remove("pos-left","pos-center","pos-right");
      el.classList.add(posClass);
    }
    function moveInstant(el, posClass){
      el.classList.add("no-trans");
      setPos(el, posClass);
      el.offsetHeight;
      el.classList.remove("no-trans");
    }

    (function init(){
  var images = (Array.isArray(IMAGE_LIST) && IMAGE_LIST.length) ? IMAGE_LIST.slice() : [];
  if (images.length === 0) return;

  function candidatesFor(s){
    s = String(s || "");
    if (!s) return [];

    // data/blob/http(s) sind immer direkt gültig
    if (/^(data:|blob:|https?:\/\/)/i.test(s)) return [s];

    // Wenn schon relativ/absolut geschrieben, trotzdem Fallbacks anbieten
    var raw = s.replace(/^(\.\/)+/,''); // "./1.jpg" -> "1.jpg"

    return [
      s,                 // wie es kommt (kann durch <base> zu assets/... werden)
      "./" + raw,         // explizit local
      "assets/" + raw,    // falls Bilder doch in assets liegen
      "../" + raw,        // Preview mit <base href="./assets/">
      "../assets/" + raw  // letzter Versuch
    ];
  }

  function setImgWithFallback(imgEl, src){
    var list = candidatesFor(src);
    var i = 0;

    imgEl.onerror = function(){
      i++;
      if (i >= list.length){
        imgEl.onerror = null;
        return;
      }
      imgEl.src = list[i];
    };

    // Start
    imgEl.src = list[0];
  }

  // Preload (best effort)
  images.forEach(function(s){
    candidatesFor(s).forEach(function(c){
      var im = new Image();
      im.src = c;
    });
  });

  // Erstbefüllung
  setImgWithFallback(slideA, images[0] || "");
  setImgWithFallback(slideB, images[images.length > 1 ? 1 : 0] || "");

  slideA.className = "slide pos-center";
  slideB.className = "slide pos-right";

  var idx = 0;
  var busy = false;
  var aIsCurrent = true;

  function setPos(el, posClass){
    el.classList.remove("pos-left","pos-center","pos-right");
    el.classList.add(posClass);
  }
  function moveInstant(el, posClass){
    el.classList.add("no-trans");
    setPos(el, posClass);
    el.offsetHeight;
    el.classList.remove("no-trans");
  }

  function swipeOnce(){
    if (busy || images.length < 2) return;
    busy = true;

    var currentEl = aIsCurrent ? slideA : slideB;
    var nextEl    = aIsCurrent ? slideB : slideA;

    var nextIdx = (idx + 1) % images.length;
    var afterNextIdx = (idx + 2) % images.length;

    // Wichtig: immer mit Fallback setzen
    setImgWithFallback(nextEl, images[nextIdx]);

    moveInstant(nextEl, "pos-right");

    requestAnimationFrame(function(){
      setPos(currentEl, "pos-left");
      setPos(nextEl, "pos-center");
    });

    setTimeout(function(){
      moveInstant(currentEl, "pos-right");
      setImgWithFallback(currentEl, images[afterNextIdx]);

      idx = nextIdx;
      aIsCurrent = !aIsCurrent;
      busy = false;

      setTimeout(swipeOnce, HOLD_MS);
    }, SWIPE_MS);
  }

  setTimeout(function(){
    setTimeout(swipeOnce, HOLD_MS);
  }, heroFullyVisibleAt);
})();
  </script>
</body>
</html>
